#!/bin/python
import subprocess

def round_to_nearest(num):
    return round(num // 5) * 5 + 5

bat = {40:0,45:0x16,50: 0x20,55: 0x23 ,60: 0x25,65: 0x28,70: 0x30,75:0x3e }
power = {35:0xe,40:0x14,45: 0x18,50: 0x22,55: 0x25 ,60: 0x27,65: 0x30,70: 0x3e}
with open('/sys/class/power_supply/ACAD/online', 'r') as file:
    status = file.read(1)

with open('/sys/devices/virtual/thermal/thermal_zone0/temp', 'r') as file:
    temp = file.read(2)
temp=round_to_nearest(int(temp))
if(status==1):
   fan_value = power.get(temp, 0x3e)
else:
    fan_value = bat.get(temp, 0x3e)

if temp < 35 :
    fan_value=0

print(fan_value)
if fan_value == 0:
    subprocess.run(['/usr/local/bin/fan_max',str(0)])
else:
    subprocess.run(['/usr/local/bin/fan_speed', str(hex(fan_value))])